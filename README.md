# Краткое руководство по работе

### В панели администратора

1. Создать тип виртуальной машины со следующими параметрами **(имя тоже должно соответствовать!)**  
   ![image](https://github.com/kyneccc/ModuleACyber/blob/main/screenshots/flavor.png)

2. Загрузить два образа с именами: `alt-server-10.4-p10-cloud-x86_64.qcow2` и `alt-workstation-10.4-p10-cloud-x86_64.qcow2`  
   **Имена образов должны быть точно такими же**. Скачать их можно [здесь](https://ftp.altlinux.org/pub/distributions/ALTLinux/p10/images/cloud/x86_64/)  
   ![image](https://github.com/kyneccc/ModuleACyber/blob/main/screenshots/server.png)  
   ![image](https://github.com/kyneccc/ModuleACyber/blob/main/screenshots/workstation.png)

> Важно поставить галочку в поле "Использовать во всех проектах".

### В панели проекта (пользователя)

1. Создать произвольную сеть с любой адресацией, кроме тех, которые будут использоваться в самом стенде, включая сеть администрирования `10.100.100.0/24`.

2. Создать маршрутизатор (имя произвольное) и добавить туда только что созданную сеть.

3. Добавить SSH-ключ с любым именем, кроме `MgVm`.

4. Создать виртуальную машину:
   - Образ: `alt-server-10.4-p10-cloud-x86_64.qcow2`
   - Расширить диск до 8 ГБ
   - Тип виртуальной машины: Medium
   - В сетевых интерфейсах добавить интерфейс из только что созданной сети (можно оставить автоматическое назначение адреса)
   - Добавить только что созданный SSH-ключ  
     ![image](https://github.com/kyneccc/ModuleACyber/blob/main/screenshots/vm.png)

5. После создания ВМ добавить ей плавающий IP-адрес.

### Внутри машины администратора

1. ```bash
   sudo apt-get update && sudo apt-get install git -y
   ```

2. ```bash
   git clone https://github.com/kyneccc/ModuleACyber
   ```

3. Сгенерировать SSH-ключи:
   ```bash
   ssh-keygen
   ```

4. Перейти в директорию проекта:
   ```bash
   cd ModuleACyber/
   ```

5. Выполнить установочный скрипт:
   ```bash
   sudo bash before_installation.sh
   ```

6. Перейти в директорию `bin`:
   ```bash
   cd bin
   ```

7. **ОБЯЗАТЕЛЬНО** отредактируйте файл подключения к инфраструктуре `con.conf`. Проверьте подключение командой:
   ```bash
   source bin/con.conf ; openstack port list --insecure
   ```
   При успешном выполнении будет выведен список всех доступных инстансов.

8. Запустите основной скрипт, указав имя вашей машины администратора (именно то, которое вы указывали при создании, а не hostname):
   ```bash
   bash moduleA.sh AdminVM
   ```

9. Для получения доступа к виртуальным машинам используйте команду `ssh` и хостнейм ВМ. Например:
   ```bash
   ssh hq-rtr
   ```

## Удаление стенда

Для удаления стенда просто запустите скрипт `destroy.sh`:
```bash
bash destroy.sh
```
Единственный нюанс — тома от виртуальных машин придётся удалять вручную.

### При возникновении каких-либо проблем обращайтесь в [Telegram](https://t.me/kynecccc).

--- 
